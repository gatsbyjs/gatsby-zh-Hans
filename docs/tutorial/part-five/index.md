---
title: æ•°æ®æºæ’ä»¶
typora-copy-images-to: ./
disableTableOfContents: true
---

> æœ¬ç« æ•™ç¨‹æ˜¯ Gatsby æ•°æ®å±‚ç³»åˆ—çš„ä¸€éƒ¨åˆ†ã€‚åœ¨ç»§ç»­ä¹‹å‰ï¼Œç¡®ä¿ä½ å·²ç»è¯»è¿‡ä¸€é [ç¬¬ 4 ç« ](/tutorial/part-four/) æ•™ç¨‹ã€‚

## è¿™ç« æ•™ç¨‹é‡Œæœ‰ä»€ä¹ˆ?

åœ¨æœ¬ç« æ•™ç¨‹ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ GraphQL å’Œæ•°æ®æºæ’ä»¶å°†æ•°æ®æå–åˆ° Gatsby ç«™ç‚¹ä¸­ã€‚ä½†æ˜¯åœ¨å­¦ä¹ è¿™äº›æ’ä»¶ä¹‹å‰ï¼Œä½ éœ€è¦äº†è§£å¦‚ä½•ä½¿ç”¨ä¸€ä¸ªå«åš GraphiQL çš„å·¥å…·ï¼Œè¯¥å·¥å…·å¯å¸®åŠ©ä½ æ­£ç¡®æ„å»ºæŸ¥è¯¢è¯­å¥ã€‚

## ä»‹ç» GraphiQL

GraphiQL æ˜¯ GraphQL çš„é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰ã€‚å®ƒåŠŸèƒ½å¼ºå¤§ï¼Œä¸”å„æ–¹é¢éƒ½å¾ˆæ£’ï¼Œåœ¨ä½ æ„å»º Gatsby ç½‘ç«™æ—¶ä¼šç»å¸¸ä½¿ç”¨ã€‚

<<<<<<< HEAD
ä½ å¯ä»¥åœ¨ç«™ç‚¹çš„å¼€å‘æœåŠ¡å™¨æ­£åœ¨è¿è¡Œçš„æ—¶å€™è®¿é—®å®ƒâ€”â€”åœ°å€é€šå¸¸æ˜¯ï¼š
<http://localhost:8000/___graphql>ã€‚
=======
You can access it when your site's development server is runningâ€”normally at
`http://localhost:8000/___graphql`.
>>>>>>> 90932a06db2e297cf416552b84e48b4b82e56fbc

<video controls="controls" autoplay="true" loop="true">
  <source type="video/mp4" src="/graphiql-explore.mp4"></source>
  <p>Your browser does not support the video element.</p>
</video>

æ£€æŸ¥ä¸€ä¸‹å†…ç½®çš„ `Site` "ç±»å‹"ï¼Œçœ‹çœ‹é‡Œé¢æœ‰å“ªäº›å­—æ®µå¯ç”¨â€”â€”å®ƒåŒ…æ‹¬äº†ä½ å…ˆå‰æŸ¥è¯¢è¿‡çš„ `siteMetadata` å¯¹è±¡ã€‚å°è¯•æ‰“å¼€ GraphiQL å¹¶ç©ç©çœ‹è¿™äº›æ•°æ®ï¼æŒ‰ä¸‹ <kbd>Ctrl + Space</kbd>ï¼ˆæˆ– <kbd>Shift + Space</kbd>ï¼‰æ¥è°ƒå‡ºè‡ªåŠ¨å®Œæˆçª—å£ï¼Œç„¶åæŒ‰ä¸‹ <kbd>Ctrl + Enter</kbd> æ¥è¿è¡Œ GraphQL çš„æŸ¥è¯¢ã€‚åœ¨æœ¬æ•™ç¨‹çš„å…¶ä½™éƒ¨åˆ†ä¸­ï¼Œä½ å°†ä½¿ç”¨åˆ° GraphiQL çš„æ›´å¤šåŠŸèƒ½ã€‚

## ä½¿ç”¨ GraphiQL Explorer

GraphiQL Explorer ä½¿ä½ å¯ä»¥é€šè¿‡ç‚¹å‡»å¯ç”¨çš„å­—æ®µå’Œåœ¨è¾“å…¥æ¡†é‡Œè¾“å…¥çš„æ–¹å¼ï¼Œæ¥äº¤äº’å¼åœ°æ„å»ºå®Œæ•´çš„æŸ¥è¯¢ï¼Œè€Œæ— éœ€é‡å¤æ‰‹å·¥è¾“å…¥çš„è¿‡ç¨‹æ¥å®ŒæˆæŸ¥è¯¢ã€‚

<EggheadEmbed
  lessonLink="https://egghead.io/lessons/gatsby-build-a-graphql-query-using-gatsby-s-graphiql-explorer"
  lessonTitle="Build a GraphQL Query using Gatsbyâ€™s GraphiQL Explorer"
/>

## æ•°æ®æºæ’ä»¶

Gatsby ç½‘ç«™ä¸­çš„æ•°æ®å¯ä»¥æ¥è‡ªä»»ä½•åœ°æ–¹ï¼šAPIã€æ•°æ®åº“ã€CMSã€æœ¬åœ°æ–‡ä»¶ç­‰ç­‰ã€‚

æ•°æ®æºæ’ä»¶å¯ä»¥ä»å…¶æ•°æ®æºä¸­è·å–æ•°æ®ã€‚ä¾‹å¦‚æ–‡ä»¶ç³»ç»Ÿæºæ’ä»¶çŸ¥é“å¦‚ä½•ä»æ–‡ä»¶ç³»ç»Ÿä¸­è·å–æ•°æ®ã€‚ WordPress æ’ä»¶çŸ¥é“å¦‚ä½•ä» WordPress API è·å–æ•°æ®ã€‚

æ·»åŠ  [`gatsby-source-filesystem`](/packages/gatsby-source-filesystem/) è¿™ä¸ªæ’ä»¶å¹¶æ¢ç´¢ä¸€ä¸‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

é¦–å…ˆï¼Œå°†æ’ä»¶å®‰è£…åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ï¼š

```shell
npm install --save gatsby-source-filesystem
```

ç„¶åæŠŠè¿™äº›ä»£ç æ·»åŠ åˆ° `gatsby-config.js`:

```javascript:title=gatsby-config.js
module.exports = {
  siteMetadata: {
    title: `Pandas Eating Lots`,
  },
  plugins: [
    // highlight-start
    {
      resolve: `gatsby-source-filesystem`,
      options: {
        name: `src`,
        path: `${__dirname}/src/`,
      },
    },
    // highlight-end
    `gatsby-plugin-emotion`,
    {
      resolve: `gatsby-plugin-typography`,
      options: {
        pathToConfigModule: `src/utils/typography`,
      },
    },
  ],
}
```

ä¿å­˜è¿™ä¸ªæ–‡ä»¶ç„¶åé‡å¯ Gatsby å¼€å‘æœåŠ¡å™¨ã€‚ç„¶åé‡æ–°æ‰“å¼€ GraphiQLã€‚

åœ¨ explorer é¢æ¿é‡Œï¼Œä½ ä¼šçœ‹è§ `allFile` å’Œ `file` è¿™ä¸¤ä¸ªå¯é€‰é¡¹ï¼š

![GraphiQL æ–‡ä»¶ç³»ç»Ÿ](graphiql-filesystem.png)

ç‚¹å‡» `allFile` ä¸‹æ‹‰æŒ‰é’®ï¼Œåœ¨ query è¾“å…¥æ¡†ä¸­ï¼ŒæŠŠå…‰æ ‡æ”¾åœ¨ `allFile` ä¹‹åï¼Œç„¶åæŒ‰ä¸‹ <kbd>Ctrl + Enter</kbd>ã€‚å®ƒä¼šä¸ºä½ è‡ªåŠ¨å¡«å¥½æŸ¥è¯¢æ‰€æœ‰æ–‡ä»¶çš„è¯­å¥ã€‚æŒ‰ä¸‹ â€œPlayâ€ æŒ‰é’®æ¥è¿è¡ŒæŸ¥è¯¢è¯­å¥ï¼š

![æ–‡ä»¶ç³»ç»ŸæŸ¥è¯¢](filesystem-query.png)

åœ¨ explorer é¢æ¿ä¸­ï¼Œ`id` å­—æ®µå·²ç»è¢«è‡ªåŠ¨é€‰æ‹©äº†ã€‚é€šè¿‡é€‰ä¸­å­—æ®µçš„ç›¸åº”å¤é€‰æ¡†æ¥é€‰æ‹©æ›´å¤šå­—æ®µã€‚æŒ‰ä¸‹ â€œPlayâ€ æŒ‰é’®ä»¥ä½¿ç”¨æ–°å­—æ®µå†æ¬¡è¿è¡ŒæŸ¥è¯¢ï¼š

![æ–‡ä»¶ç³»ç»Ÿçš„ explorer é€‰é¡¹](filesystem-explorer-options.png)

æˆ–è€…ï¼Œä½ å¯ä»¥ä½¿ç”¨è‡ªåŠ¨å®Œæˆçš„å¿«æ·é”®ï¼ˆ<kbd>Ctrl + Space</kbd>ï¼‰ã€‚è¿™å°†åœ¨ `File` èŠ‚ç‚¹ä¸Šæ˜¾ç¤ºå¯æŸ¥è¯¢çš„å­—æ®µã€‚

![æ–‡ä»¶ç³»ç»Ÿçš„è‡ªåŠ¨å®Œæˆ](filesystem-autocomplete.png)

<<<<<<< HEAD
å°è¯•åœ¨æŸ¥è¯¢ä¸­æ·»åŠ è®¸å¤šå­—æ®µï¼Œæ¯æ¬¡è¦é‡æ–°è¿è¡ŒæŸ¥è¯¢çš„æ—¶å€™æŒ‰ä¸‹ <kbd>Ctrl + Enter</kbd>ã€‚ä½ ä¼šçœ‹åˆ°æ›´æ–°åçš„æŸ¥è¯¢ç»“æœï¼š
=======
Try adding a number of fields to your query, press <kbd>Ctrl + Enter</kbd>
each time to re-run the query. You'll see the updated query results:
>>>>>>> 90932a06db2e297cf416552b84e48b4b82e56fbc

![æ‰€æœ‰æ–‡ä»¶çš„æŸ¥è¯¢](allfile-query.png)

ç»“æœæ˜¯ä¸€ä¸ª `File` â€œèŠ‚ç‚¹â€ çš„æ•°ç»„ï¼ˆèŠ‚ç‚¹ï¼ˆnodeï¼‰æ˜¯å›¾ï¼ˆgraphï¼‰ä¸­ä¸€ä¸ªå¯¹è±¡çš„ç‰¹æ®Šç§°å‘¼ï¼‰ã€‚æ¯ä¸ª `File` èŠ‚ç‚¹å¯¹è±¡éƒ½åŒ…å«äº†ä½ è¦æŸ¥è¯¢çš„å­—æ®µã€‚

## é€šè¿‡ GraphQL æŸ¥è¯¢è¯­å¥æ¥æ„å»ºä¸€ä¸ªé¡µé¢

ç”¨ Gastby æ„å»ºæ–°é¡µé¢çš„è¿‡ç¨‹é€šå¸¸å¼€å§‹äº GraphiQLã€‚ä½ å…ˆåœ¨ GraphiQL æµ‹è¯•å‡ºæ•°æ®æŸ¥è¯¢è¯­å¥ï¼Œç„¶åæŠŠ query è¾“å…¥æ¡†é‡Œçš„è¯­å¥å¤åˆ¶åˆ°ä½ çš„ React é¡µé¢ç»„ä»¶é‡Œï¼Œæ¥ä¸‹æ¥æ‰å¼€å§‹æ„å»º UIã€‚

è®©æˆ‘ä»¬è¯•è¯•çœ‹è¿™ä¸ªã€‚

ç”¨ä½ åˆšåˆšåˆ›å»ºå¥½çš„ `allFile` GraphQL æŸ¥è¯¢è¯­å¥æ¥åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ `src/pages/my-files.js`

```jsx:title=src/pages/my-files.js
import React from "react"
import { graphql } from "gatsby"
import Layout from "../components/layout"

export default ({ data }) => {
  console.log(data) // highlight-line
  return (
    <Layout>
      <div>Hello world</div>
    </Layout>
  )
}

export const query = graphql`
  query {
    allFile {
      edges {
        node {
          relativePath
          prettySize
          extension
          birthTime(fromNow: true)
        }
      }
    }
  }
`
```

`console.log(data)` è¿™ä¸€è¡Œåœ¨ä¸Šé¢é«˜äº®æ˜¾ç¤ºå‡ºæ¥äº†ã€‚å½“è¦åˆ›å»ºä¸€ä¸ªæ–°ç»„ä»¶æ—¶ï¼Œåœ¨æ§åˆ¶å°æ‰“å°å‡ºä» GraphQL æŸ¥è¯¢åˆ°çš„æ•°æ®é€šå¸¸ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚ä½ åœ¨æ„å»º UI æ—¶å°±å¯ä»¥åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­æµè§ˆæ•°æ®ã€‚

å¦‚æœä½ è®¿é—®äº†ä¸€ä¸ªæ–°é¡µé¢ `/my-files/` å¹¶æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼äºï¼š

![æ§åˆ¶å°ä¸­æ˜¾ç¤ºçš„æ•°æ®](data-in-console.png)

å›¾ç‰‡é‡Œçš„æ•°æ®å’Œ GraphQL æŸ¥è¯¢è¯­å¥æ˜¯ç›¸åŒ¹é…çš„ã€‚

è®©æˆ‘ä»¬ç»§ç»­æ·»åŠ ä¸€äº›ä»£ç æ¥æ˜¾ç¤ºå‡ºæ–‡ä»¶æ•°æ®ã€‚

```jsx:title=src/pages/my-files.js
import React from "react"
import { graphql } from "gatsby"
import Layout from "../components/layout"

export default ({ data }) => {
  console.log(data)
  return (
    <Layout>
      {/* highlight-start */}
      <div>
        <h1>My Site's Files</h1>
        <table>
          <thead>
            <tr>
              <th>relativePath</th>
              <th>prettySize</th>
              <th>extension</th>
              <th>birthTime</th>
            </tr>
          </thead>
          <tbody>
            {data.allFile.edges.map(({ node }, index) => (
              <tr key={index}>
                <td>{node.relativePath}</td>
                <td>{node.prettySize}</td>
                <td>{node.extension}</td>
                <td>{node.birthTime}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
      {/* highlight-end */}
    </Layout>
  )
}

export const query = graphql`
  query {
    allFile {
      edges {
        node {
          relativePath
          prettySize
          extension
          birthTime(fromNow: true)
        }
      }
    }
  }
`
```

<<<<<<< HEAD
ç„¶åè®¿é—® [http://localhost:8000/my-files](http://localhost:8000/my-files)â€¦ ğŸ˜²
=======
And now visit `http://localhost:8000/my-files`â€¦ ğŸ˜²
>>>>>>> 90932a06db2e297cf416552b84e48b4b82e56fbc

![æˆ‘çš„æ–‡ä»¶é¡µé¢](my-files-page.png)

## æ¥ä¸‹æ¥ï¼Ÿ

ç°åœ¨ï¼Œä½ å·²ç»äº†è§£äº†æ•°æ®æºæ’ä»¶å¦‚ä½•å°†æ•°æ® _å¼•å…¥_ Gatsby çš„æ•°æ®ç³»ç»Ÿã€‚åœ¨ä¸‹ä¸€ç« æ•™ç¨‹ä¸­ï¼Œä½ å°†å­¦ä¹ æ•°æ®è½¬æ¢æ’ä»¶å¦‚ä½• _è½¬æ¢_ æ•°æ®æºæ’ä»¶ç»™å‡ºçš„åŸå§‹æ•°æ®ã€‚é€šè¿‡æ•°æ®æºæ’ä»¶å’Œæ•°æ®è½¬æ¢æ’ä»¶ä¸¤è€…çš„ååŒåˆä½œï¼Œæ‰€æœ‰åœ¨æ„å»º Gatsby ç½‘ç«™æ—¶å¯èƒ½éœ€è¦çš„æ•°æ®æºå’Œæ•°æ®è½¬æ¢éƒ½èƒ½å¤Ÿå¤„ç†äº†ã€‚è®©æˆ‘ä»¬åœ¨  [ç¬¬ 6 ç« æ•™ç¨‹](/tutorial/part-six/) ä¸­äº†è§£æœ‰å…³æ•°æ®è½¬æ¢æ’ä»¶çš„ä¿¡æ¯ã€‚